import{e as i,f as n,h as a,ia as U,k as p,l as c,na as g,o as u,r as l,sa as h,z as m}from"./chunk-VO7JYHVQ.js";var f=class s{constructor(e,t){this.http=e;this.router=t;let r=localStorage.getItem("currentUser");r&&this.currentUser.set(JSON.parse(r))}apiUrl=`${h.apiBaseUrl}/users`;currentUser=m(null);getCurrentUser(){return this.currentUser()}register(e){return this.http.get(`${this.apiUrl}?email=${e.email}`).pipe(p(t=>t.length>0?i({error:"User with this email already exists."}):this.http.post(this.apiUrl,e).pipe(c(r=>{this.currentUser.set(r),localStorage.setItem("currentUser",JSON.stringify(r)),this.router.navigate(["/"])}),n(()=>({})))),a(t=>(console.error("Registration error:",t),i({error:t.message}))))}login(e,t){return this.http.get(`${this.apiUrl}?email=${e}`).pipe(n(r=>{if(r.length===0||r[0].password!==t)return{error:"Invalid email or password."};let o=r[0];return this.currentUser.set(o),localStorage.setItem("currentUser",JSON.stringify(o)),this.router.navigate(["/"]),{user:o}}),a(r=>(console.error("Login error:",r),i({error:r.message}))))}logout(){this.currentUser.set(null),localStorage.removeItem("currentUser"),this.router.navigate(["/login"])}updateUser(e){this.currentUser.set(e),localStorage.setItem("currentUser",JSON.stringify(e))}getApiUrl(){return this.apiUrl}static \u0275fac=function(t){return new(t||s)(l(U),l(g))};static \u0275prov=u({token:s,factory:s.\u0275fac,providedIn:"root"})};export{f as a};
