import{b as U,c as l,d as z,e as V,g as q,i as T,j as I,l as $,n as D}from"./chunk-WCBENI67.js";import{a as F}from"./chunk-DUZIT3LW.js";import{B as a,E as v,I as p,K as d,M as C,Q as i,R as o,S as g,T as w,U as P,V as _,W as r,X as y,a as h,b as x,ea as E,ha as N,ia as S,ra as k,s as f,sa as b,u,v as M,z as O}from"./chunk-VO7JYHVQ.js";function A(c,n){if(c&1&&(i(0,"p",1),r(1),o()),c&2){let e=_();a(),y(e.errorMessage())}}function B(c,n){if(c&1){let e=w();i(0,"div",7)(1,"button",15),P("click",function(){u(e);let s=_();return M(s.saveProfileChanges())}),r(2,"Save Changes"),o(),i(3,"button",15),P("click",function(){u(e);let s=_();return M(s.toggleEdit())}),r(4,"Cancel"),o()()}}function j(c,n){if(c&1){let e=w();i(0,"button",15),P("click",function(){u(e);let s=_();return M(s.toggleEdit())}),r(1,"Edit Profile"),o()}}function R(c,n){c&1&&(i(0,"p",1),r(1," Password must be at least 8 characters long, include a digit and an uppercase letter. "),o())}function Z(c,n){c&1&&(i(0,"p",1),r(1,"Passwords must match"),o())}var G=class c{fb=f($);authService=f(F);http=f(S);user=O(null);isEditing=O(!1);errorMessage=O(null);profileForm=this.fb.group({fullName:this.fb.control("",{validators:[l.required,l.pattern("^[A-Za-z]+$")]}),email:this.fb.control("",{validators:[l.required,l.email]})});passwordForm=this.fb.group({currentPassword:this.fb.control(""),newPassword:this.fb.control("",{validators:[l.minLength(8),l.pattern("^(?=.*[A-Z])(?=.*\\d).+$")]}),confirmPassword:this.fb.control("")});constructor(){E(()=>{let n=this.authService.getCurrentUser();n&&(this.user.set(n),this.profileForm.patchValue({fullName:n.fullName,email:n.email}))})}toggleEdit(){this.isEditing.set(!this.isEditing())}saveProfileChanges(){if(!this.user())return;let n=x(h({},this.user()),{fullName:this.profileForm.value.fullName||"",email:this.profileForm.value.email||""});this.http.get(`${b.apiBaseUrl}/users?email=${n.email}`).subscribe(e=>{if(e.length>0&&e[0].id!==n.id){this.errorMessage.set("This email is already in use. Please use a different one.");return}this.http.put(`${b.apiBaseUrl}/users/${n.id}`,n).subscribe(()=>{this.user.set(n),this.authService.updateUser(n),this.isEditing.set(!1),this.errorMessage.set(null)})})}changePassword(){if(!this.user())return;let n=this.user(),{currentPassword:e,newPassword:t,confirmPassword:s}=this.passwordForm.getRawValue();if(n.password!==e){this.errorMessage.set("Current password is incorrect.");return}if(t!==s){this.errorMessage.set("New passwords do not match.");return}if(!this.passwordForm.controls.newPassword.valid){this.errorMessage.set("Password must be at least 8 characters long, include a digit and an uppercase letter.");return}let m=x(h({},n),{password:t});this.http.put(`${b.apiBaseUrl}/users/${m.id}`,m).subscribe(()=>{this.user.set(m),this.authService.updateUser(m),this.errorMessage.set(null),this.passwordForm.reset()})}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=v({type:c,selectors:[["app-profile"]],decls:29,vars:8,consts:[[1,"profile-container"],[1,"error"],[3,"formGroup"],["for","fullName"],["id","fullName","type","text","formControlName","fullName",3,"readonly"],["for","email"],["id","email","type","email","formControlName","email",3,"readonly"],[1,"change-buttons"],["type","button"],["for","currentPassword"],["id","currentPassword","type","password","formControlName","currentPassword"],["for","newPassword"],["id","newPassword","type","password","formControlName","newPassword"],["for","confirmPassword"],["id","confirmPassword","type","password","formControlName","confirmPassword"],["type","button",3,"click"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"h2"),r(2,"My Profile"),o(),p(3,A,2,1,"p",1),i(4,"form",2)(5,"label",3),r(6,"Full Name"),o(),g(7,"input",4),i(8,"label",5),r(9,"Email"),o(),g(10,"input",6),p(11,B,5,0,"div",7)(12,j,2,0,"button",8),o(),i(13,"h3"),r(14,"Change Password"),o(),i(15,"form",2)(16,"label",9),r(17,"Current Password"),o(),g(18,"input",10),i(19,"label",11),r(20,"New Password"),o(),g(21,"input",12),p(22,R,2,0,"p",1),i(23,"label",13),r(24,"Confirm New Password"),o(),g(25,"input",14),p(26,Z,2,0,"p",1),i(27,"button",15),P("click",function(){return t.changePassword()}),r(28,"Change Password"),o()()()),e&2&&(a(3),C(t.errorMessage()?3:-1),a(),d("formGroup",t.profileForm),a(3),d("readonly",!t.isEditing()),a(3),d("readonly",!t.isEditing()),a(),C(t.isEditing()?11:12),a(4),d("formGroup",t.passwordForm),a(7),C(t.passwordForm.controls.newPassword.invalid&&t.passwordForm.controls.newPassword.touched?22:-1),a(4),C(t.passwordForm.value.newPassword!==t.passwordForm.value.confirmPassword&&t.passwordForm.controls.confirmPassword.touched?26:-1))},dependencies:[N,D,q,U,z,V,T,I,k],styles:['html[_ngcontent-%COMP%], body[_ngcontent-%COMP%], div[_ngcontent-%COMP%], span[_ngcontent-%COMP%], applet[_ngcontent-%COMP%], object[_ngcontent-%COMP%], iframe[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], p[_ngcontent-%COMP%], blockquote[_ngcontent-%COMP%], pre[_ngcontent-%COMP%], a[_ngcontent-%COMP%], abbr[_ngcontent-%COMP%], acronym[_ngcontent-%COMP%], address[_ngcontent-%COMP%], big[_ngcontent-%COMP%], cite[_ngcontent-%COMP%], code[_ngcontent-%COMP%], del[_ngcontent-%COMP%], dfn[_ngcontent-%COMP%], em[_ngcontent-%COMP%], img[_ngcontent-%COMP%], ins[_ngcontent-%COMP%], kbd[_ngcontent-%COMP%], q[_ngcontent-%COMP%], s[_ngcontent-%COMP%], samp[_ngcontent-%COMP%], small[_ngcontent-%COMP%], strike[_ngcontent-%COMP%], strong[_ngcontent-%COMP%], sub[_ngcontent-%COMP%], sup[_ngcontent-%COMP%], tt[_ngcontent-%COMP%], var[_ngcontent-%COMP%], b[_ngcontent-%COMP%], u[_ngcontent-%COMP%], i[_ngcontent-%COMP%], center[_ngcontent-%COMP%], dl[_ngcontent-%COMP%], dt[_ngcontent-%COMP%], dd[_ngcontent-%COMP%], ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%], li[_ngcontent-%COMP%], fieldset[_ngcontent-%COMP%], form[_ngcontent-%COMP%], label[_ngcontent-%COMP%], legend[_ngcontent-%COMP%], table[_ngcontent-%COMP%], caption[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%], tfoot[_ngcontent-%COMP%], thead[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%], article[_ngcontent-%COMP%], aside[_ngcontent-%COMP%], canvas[_ngcontent-%COMP%], details[_ngcontent-%COMP%], embed[_ngcontent-%COMP%], figure[_ngcontent-%COMP%], figcaption[_ngcontent-%COMP%], footer[_ngcontent-%COMP%], header[_ngcontent-%COMP%], hgroup[_ngcontent-%COMP%], menu[_ngcontent-%COMP%], nav[_ngcontent-%COMP%], output[_ngcontent-%COMP%], ruby[_ngcontent-%COMP%], section[_ngcontent-%COMP%], summary[_ngcontent-%COMP%], time[_ngcontent-%COMP%], mark[_ngcontent-%COMP%], audio[_ngcontent-%COMP%], video[_ngcontent-%COMP%]{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article[_ngcontent-%COMP%], aside[_ngcontent-%COMP%], details[_ngcontent-%COMP%], figcaption[_ngcontent-%COMP%], figure[_ngcontent-%COMP%], footer[_ngcontent-%COMP%], header[_ngcontent-%COMP%], hgroup[_ngcontent-%COMP%], menu[_ngcontent-%COMP%], nav[_ngcontent-%COMP%], section[_ngcontent-%COMP%]{display:block}body[_ngcontent-%COMP%]{line-height:1}ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{list-style:none}blockquote[_ngcontent-%COMP%], q[_ngcontent-%COMP%]{quotes:none}blockquote[_ngcontent-%COMP%]:before, blockquote[_ngcontent-%COMP%]:after, q[_ngcontent-%COMP%]:before, q[_ngcontent-%COMP%]:after{content:"";content:none}table[_ngcontent-%COMP%]{border-collapse:collapse;border-spacing:0}a[_ngcontent-%COMP%]{text-decoration:none}*[_ngcontent-%COMP%]{box-sizing:border-box}.profile-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:600px;margin:60px auto;background-color:#222d33;color:#333;padding:40px;border-radius:8px;box-shadow:0 2px 10px #0000001a}.profile-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:16px;font-size:26px;text-align:center;color:#fff}.profile-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;color:#fff;font-size:18px;font-weight:400;padding:20px 0}.profile-container[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#ff5c5c;margin-bottom:8px;font-size:14px;text-align:center}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:24px}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;margin:8px 0 4px;color:#fff}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{padding:8px;border:1px solid #ddd;border-radius:4px;font-size:14px;margin-bottom:8px}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus, .profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]:focus, .profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]:focus{outline:none;border-color:#2e859e}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .change-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:10px}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .change-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;flex:1}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:12px;padding:10px 0;background-color:#2e859e;border:none;border-radius:4px;color:#fff;font-size:16px;cursor:pointer;transition:background-color .3s ease}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#ff5c5c}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.profile-container[_ngcontent-%COMP%]   .profile-form[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;padding-bottom:16px;margin-bottom:16px}@media (max-width: 768px){.profile-container[_ngcontent-%COMP%]{padding:20px}.profile-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px}.profile-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .change-buttons[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .change-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 640px){.profile-container[_ngcontent-%COMP%]{margin:60px 20px}.profile-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:6px}.profile-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px}}'],changeDetection:0})};export{G as ProfileComponent};
